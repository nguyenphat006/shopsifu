@startuml Review - Update Activity
!theme plain
skinparam backgroundColor #FFFFFF
skinparam activityFontSize 12
skinparam activityFontColor #333333
skinparam activityBorderColor #666666
skinparam activityBackgroundColor #F7F7F7

title Hoạt Động: PUT /reviews/:reviewId

start
:Nhận reviewId + body + user;
:validateOrder(orderId,userId) & validateUpdateReview(reviewId,userId);
if (Hợp lệ?) then (Có)
  :BEGIN TRANSACTION;
  :review.update (increment updateCount);
  :reviewMedia.deleteMany(reviewId);
  :reviewMedia.createManyAndReturn(medias);
  :COMMIT;
  :Build message i18n;
  :Trả về 200 { message, data };
else (Không)
  :Ném BadRequest/NotFound theo case;
endif
stop

@enduml


